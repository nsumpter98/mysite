import{r as t,c as s,w as i,h as e,H as o,e as n}from"./p-9e7122fd.js";import{c as r,g as a}from"./p-fa12caf6.js";import{p as h}from"./p-7e57a929.js";import{i as l}from"./p-506221fe.js";import{c,h as d}from"./p-69e7783d.js";const u=class{constructor(i){t(this,i),this.ionChange=s(this,"ionChange",7),this.ionSelect=s(this,"ionSelect",7),this.ionStyle=s(this,"ionStyle",7),this.didInit=!1,this.activated=!1,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.selectOnFocus=!1,this.onClick=t=>{const s=t.target,i=this.checked;"ION-SEGMENT"!==s.tagName&&(this.value=s.value,!this.scrollable&&this.swipeGesture||(i?this.checkButton(i,s):this.setCheckedClasses()),this.checked=s)},this.getSegmentButton=t=>{const s=this.getButtons().filter((t=>!t.disabled)),i=s.findIndex((t=>t===document.activeElement));switch(t){case"first":return s[0];case"last":return s[s.length-1];case"next":return s[i+1]||s[0];case"previous":return s[i-1]||s[s.length-1];default:return null}}}colorChanged(t,s){(void 0===s&&void 0!==t||void 0!==s&&void 0===t)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(t,s){this.ionSelect.emit({value:t}),(""!==s||this.didInit)&&(this.activated?this.valueAfterGesture=t:this.ionChange.emit({value:t}))}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const s of t)s.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.ensureFocusable(),this.gesture=(await import("./p-b3e6427d.js")).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gestureChanged(),this.disabled&&this.disabledChanged(),this.didInit=!0}onStart(t){this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1);const s=this.setNextIndex(t,!0);t.event.stopImmediatePropagation(),s&&this.addRipple(t);const i=this.valueAfterGesture;void 0!==i&&(this.ionChange.emit({value:i}),this.valueAfterGesture=void 0)}getButtons(){return Array.from(this.el.querySelectorAll("ion-segment-button"))}addRipple(t){if(!r.getBoolean("animated",!0)||!r.getBoolean("rippleEffect",!0))return;const s=this.getButtons().find((t=>t.value===this.value)),i=(s.shadowRoot||s).querySelector("ion-ripple-effect");if(!i)return;const{x:e,y:o}=h(t.event);i.addRipple(e,o).then((t=>t()))}setActivated(t){this.getButtons().forEach((s=>{t?s.classList.add("segment-button-activated"):s.classList.remove("segment-button-activated")})),this.activated=t}activate(t){const s=t.event.target,i=this.getButtons().find((t=>t.value===this.value));"ION-SEGMENT-BUTTON"===s.tagName&&(i||(this.value=s.value,this.setCheckedClasses()),this.value===s.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,s){const e=this.getIndicator(t),o=this.getIndicator(s);if(null===e||null===o)return;const n=e.getBoundingClientRect(),r=o.getBoundingClientRect(),a=`translate3d(${n.left-r.left}px, 0, 0) scaleX(${n.width/r.width})`;i((()=>{o.classList.remove("segment-button-indicator-animated"),o.style.setProperty("transform",a),o.getBoundingClientRect(),o.classList.add("segment-button-indicator-animated"),o.style.setProperty("transform","")})),this.value=s.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),s=t.findIndex((t=>t.value===this.value))+1;this.checked=t.find((t=>t.value===this.value));for(const s of t)s.classList.remove("segment-button-after-checked");s<t.length&&t[s].classList.add("segment-button-after-checked")}setNextIndex(t,s=!1){const i=l(this.el),e=this.activated,o=this.getButtons(),n=o.findIndex((t=>t.value===this.value)),r=o[n];let a,h;if(-1===n)return;const c=r.getBoundingClientRect(),d=c.left,u=c.width,g=t.currentX,m=c.top+c.height/2,b=this.el.getRootNode().elementFromPoint(g,m);if(e&&!s){if(i?g>d+u:g<d){const t=n-1;t>=0&&(h=t)}else if((i?g<d:g>d+u)&&e&&!s){const t=n+1;t<o.length&&(h=t)}void 0===h||o[h].disabled||(a=o[h])}if(!e&&s&&(a=b),null!=a){if("ION-SEGMENT"===a.tagName)return!1;r!==a&&this.checkButton(r,a)}return!0}emitStyle(){this.ionStyle.emit({segment:!0})}onKeyDown(t){const s=l(this.el);let i,e=this.selectOnFocus;switch(t.key){case"ArrowRight":t.preventDefault(),i=this.getSegmentButton(s?"previous":"next");break;case"ArrowLeft":t.preventDefault(),i=this.getSegmentButton(s?"next":"previous");break;case"Home":t.preventDefault(),i=this.getSegmentButton("first");break;case"End":t.preventDefault(),i=this.getSegmentButton("last");break;case" ":case"Enter":t.preventDefault(),i=document.activeElement,e=!0}i&&(e&&this.checkButton(this.checked||i,i),i.focus())}ensureFocusable(){var t;void 0===this.value&&(null===(t=this.getButtons()[0])||void 0===t||t.setAttribute("tabindex","0"))}render(){const t=a(this);return e(o,{role:"tablist",onClick:this.onClick,class:c(this.color,{[t]:!0,"in-toolbar":d("ion-toolbar",this.el),"in-toolbar-color":d("ion-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},e("slot",null))}get el(){return n(this)}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}};u.style={ios:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:stretch;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;user-select:none}:host(.segment-scrollable){justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;overflow:hidden;z-index:0}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.065)}:host(.in-toolbar){margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;width:auto}@supports (margin-inline-start: 0) or (-webkit-margin-start: 0){:host(.in-toolbar){margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.in-toolbar:not(.ion-color)){background:var(--ion-toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.ion-color)){background:rgba(var(--ion-color-contrast-rgb), 0.11)}",md:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:stretch;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;user-select:none}:host(.segment-scrollable){justify-content:start;width:auto;overflow-x:auto}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:transparent}:host(.segment-scrollable) ::slotted(ion-segment-button){min-width:auto}"};export{u as ion_segment}